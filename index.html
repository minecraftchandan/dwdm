<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Genshin Impact Survey Insights - Analyst Report</title>
<!-- SheetJS CDN Link for XLSX parsing -->
<script src="https://unpkg.com/xlsx/dist/xlsx/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<!-- Google Fonts for a professional look -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&amp;family=Merriweather:wght@400;700&amp;family=Fira+Code&amp;display=swap" rel="stylesheet"/>
<style>
        /* --- CSS Variables for Themes --- */
        :root {
            /* Light Mode Defaults */
            --color-primary: #060606; /* Dark Blue/Charcoal for main headings, borders */
            --color-secondary: #3498db; /* Professional Blue for sub-headings, accents */
            --color-text-dark: #34495e; /* Dark Gray for body text */
            --color-text-light: #7f8c8d; /* Muted Gray for secondary text */
            --color-background-light: #ecf0f1; /* Light Gray background */
            --color-card-background: #ffffff; /* White for content cards */
            --color-border: #bdc3c7; /* Light Gray border */
            --color-code-bg: #282c34; /* Dark background for code (Atom One Dark-like) */
            --color-code-text: #abb2bf; /* Light gray for code text */
            --color-code-highlight: #61afef; /* Blue for code highlights */
            --color-section-block-bg: #f8f9fa; /* Very light gray for section blocks */
            --color-graph-section-bg: #f0f4f8; /* Light gray for graph sections */
            --color-table-header-bg: #f2f2f2; /* Table header background */
            --color-table-row-even-bg: #f9f9f9; /* Table even row background */
            --color-table-row-hover-bg: #eef5f9; /* Table row hover background */
            --color-button-primary-hover: #2980b9; /* Darker blue for primary button hover */
            --color-button-secondary-text: var(--color-secondary); /* Secondary button text color */
            --color-button-secondary-hover-bg: var(--color-secondary); /* Secondary button hover background */
            --color-button-secondary-hover-text: white; /* Secondary button hover text color */
            --color-toggle-bg: #ccc;
            --color-toggle-circle: white;
            --color-toggle-checked-bg: #66bb6a; /* Green for checked toggle */

            --shadow-subtle: 0 2px 4px rgba(0, 0, 0, 0.05);
            --shadow-medium: 0 4px 8px rgba(0, 0, 0, 0.1);
            --shadow-strong: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        /* Dark Mode Variables (Black & White with Glow) */
        body.dark-mode {
            --color-primary: #ffffff; /* White for main headings */
            --color-secondary: #eeeeee; /* Off-white for sub-headings */
            --color-accent: #ffffff; /* White for highlights */
            --color-text-dark: #f0f0f0; /* Light gray for body text */
            --color-text-light: #cccccc; /* Muted light gray */
            --color-background-light: #000000; /* Pure Black background */
            --color-card-background: #1a1a1a; /* Matte Black for content cards */
            --color-border: #333333; /* Dark gray border */
            --color-code-bg: #0a0a0a; /* Even darker black for code */
            --color-code-text: #e0e0e0; /* Light gray for code text */
            --color-code-highlight: #ffffff; /* Pure white for code highlights */
            --color-section-block-bg: #101010; /* Darker matte black for section blocks */
            --color-graph-section-bg: #080808; /* Even darker matte black for graph sections */
            --color-table-header-bg: #222222; /* Dark gray for table header */
            --color-table-row-even-bg: #151515; /* Darker matte black for even rows */
            --color-table-row-hover-bg: #252525; /* Slightly lighter matte black on hover */
            --color-button-primary-hover: #444444; /* Darker gray for primary button hover */
            --color-button-secondary-text: #ffffff; /* White for secondary button text */
            --color-button-secondary-hover-bg: #ffffff; /* White for secondary button hover background */
            --color-button-secondary-hover-text: #000000; /* Black for secondary button hover text */
            --color-toggle-bg: #555555;
            --color-toggle-circle: #ffffff;
            --color-toggle-checked-bg: #ffffff; /* White for checked toggle */
            

            /* White Glow Shadows */
            --shadow-subtle: 0 0 5px rgba(255, 255, 255, 0.1);
            --shadow-medium: 0 0 10px rgba(255, 255, 255, 0.2);
            --shadow-strong: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        /* --- Base Styles --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--color-text-dark);
            background-color: var(--color-background-light);
            padding: 30px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth theme transition */
        }

        .report-container {
            max-width: 960px;
            width: 100%;
            background-color: var(--color-card-background);
            border-radius: 8px; /* Slightly smaller radius for a sharper look */
            box-shadow: var(--shadow-strong);
            padding: 40px 50px;
            margin-bottom: 40px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease; /* Smooth theme transition */
        }

        /* --- Typography --- */
        h1 {
            font-family: 'Merriweather', serif;
            font-size: 2.8rem;
            font-weight: 700;
            color: var(--color-primary);
            text-align: center;
            margin-bottom: 35px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--color-secondary);
            line-height: 1.25;
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        h2 {
            font-family: 'Roboto', sans-serif;
            font-size: 2.1rem;
            font-weight: 500;
            color: var(--color-secondary);
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--color-border);
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        h3 {
            font-family: 'Roboto', sans-serif;
            font-size: 1.6rem;
            font-weight: 500;
            color: var(--color-primary);
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 1px dashed var(--color-border);
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        p {
            font-size: 1.05rem;
            color: var(--color-text-dark);
            margin-bottom: 18px;
            transition: color 0.3s ease;
        }

        ul {
            list-style: disc;
            padding-left: 25px;
            color: var(--color-text-dark);
            margin-bottom: 20px;
            transition: color 0.3s ease;
        }

        ul li {
            margin-bottom: 8px;
            font-size: 1rem;
        }

        strong {
            font-weight: 700;
            color: var(--color-primary);
            transition: color 0.3s ease;
        }

        /* --- Section Blocks --- */
        .section-block {
            background-color: var(--color-section-block-bg);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-subtle);
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .section-block.highlight-primary {
            border-left: 5px solid var(--color-secondary);
        }

        .section-block.highlight-accent {
            border-left: 5px solid var(--color-accent);
        }

        /* --- Graph Sections --- */
        .graph-section {
            text-align: center;
            margin: 40px 0;
            padding: 30px;
            background-color: var(--color-graph-section-bg);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            box-shadow: var(--shadow-subtle);
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .graph-section img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            box-shadow: var(--shadow-medium);
            transition: transform 0.2s ease-in-out, box-shadow 0.3s ease;
        }

        .graph-section img:hover {
            transform: translateY(-5px) scale(1.01);
        }

        /* --- Code Blocks --- */
        .code-block-wrapper {
            background-color: var(--color-card-background);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-medium);
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .code-container {
            position: relative;
            background-color: var(--color-code-bg);
            border-radius: 4px;
            padding: 20px;
            overflow-x: auto;
            margin-top: 15px;
            font-size: 0.9rem;
            transition: background-color 0.3s ease;
        }

        code {
            font-family: 'Fira Code', monospace;
            color: var(--color-code-text);
            display: block;
            white-space: pre-wrap;
            word-break: break-all;
            padding-right: 60px; /* Space for copy button */
            transition: color 0.3s ease;
        }

        .copy-btn {
            background-color: #4a5568; /* Dark gray */
            color: var(--color-code-text);
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.75rem;
            position: absolute;
            top: 15px;
            right: 15px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, color 0.3s ease;
            border: none;
            outline: none;
        }

        .copy-btn:hover {
            background-color: #374151; /* Even darker gray */
        }

        textarea.hidden {
            display: none;
        }

        /* --- Buttons --- */
        .button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            padding: 12px 25px;
            border-radius: 4px;
            box-shadow: var(--shadow-subtle);
            transition: all 0.2s ease-in-out;
            text-decoration: none;
            cursor: pointer;
            border: 1px solid transparent; /* For consistent sizing */
        }

        .button:focus {
            outline: 2px solid var(--color-secondary);
            outline-offset: 2px;
        }

        .button.primary {
            background-color: var(--color-secondary);
            color: white;
            border-color: var(--color-secondary);
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        .button.primary:hover {
            background-color: var(--color-button-primary-hover);
            border-color: var(--color-button-primary-hover);
            box-shadow: var(--shadow-medium);
        }

        .button.secondary {
            background-color: transparent;
            color: var(--color-button-secondary-text);
            border-color: var(--color-secondary);
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        .button.secondary:hover {
            background-color: var(--color-button-secondary-hover-bg);
            color: var(--color-button-secondary-hover-text);
            box-shadow: var(--shadow-medium);
        }

        /* --- Horizontal Rule --- */
        hr {
            border: none;
            border-top: 1px dashed var(--color-border);
            margin: 40px 0;
            transition: border-color 0.3s ease;
        }

        /* --- Dataset Preview Table --- */
        #dataset-preview {
            max-height: 450px;
            overflow-y: auto;
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 15px;
            background-color: var(--color-section-block-bg); /* Use section block bg for consistency */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.03);
            margin-top: 20px;
            display: none; /* Hidden by default */
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        #dataset-preview table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
            table-layout: auto;
        }

        #dataset-preview th,
        #dataset-preview td {
            border: 1px solid var(--color-border); /* Use main border color */
            padding: 12px 15px;
            text-align: left;
            word-wrap: break-word;
            vertical-align: top;
            transition: border-color 0.3s ease;
        }

        #dataset-preview th {
            background-color: var(--color-table-header-bg);
            font-weight: 600;
            color: var(--color-primary);
            position: sticky;
            top: 0;
            z-index: 1;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        #dataset-preview tr:nth-child(even) {
            background-color: var(--color-table-row-even-bg);
            transition: background-color 0.3s ease;
        }

        #dataset-preview tr:hover {
            background-color: var(--color-table-row-hover-bg);
            transition: background-color 0.15s ease-in-out;
        }

        /* --- Button Group --- */
        .button-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
            align-items: center;
        }

        @media (min-width: 600px) {
            .button-group {
                flex-direction: row;
                justify-content: center;
            }
        }

        /* --- Toggle Switch CSS --- */
        .theme-switch-wrapper {
            display: flex;
            align-items: center;
            justify-content: flex-end; /* Align to the right */
            margin-bottom: 20px;
            gap: 10px;
            color: var(--color-text-dark);
            font-size: 0.9rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .theme-switch {
            display: inline-block;
            height: 24px;
            position: relative;
            width: 48px;
        }

        .theme-switch input {
            display: none;
        }

        .slider {
            background-color: var(--color-toggle-bg);
            bottom: 0;
            cursor: pointer;
            left: 0;
            position: absolute;
            right: 0;
            top: 0;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            background-color: var(--color-toggle-circle);
            bottom: 2px;
            content: "";
            height: 20px;
            left: 2px;
            position: absolute;
            width: 20px;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--color-toggle-checked-bg);
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }

        /* --- Responsive Adjustments --- */
        @media (max-width: 768px) {
            body {
                padding: 20px;
            }

            .report-container {
                padding: 30px;
            }

            h1 {
                font-size: 2.2rem;
                margin-bottom: 25px;
            }

            h2 {
                font-size: 1.8rem;
                margin-top: 30px;
                margin-bottom: 15px;
            }

            h3 {
                font-size: 1.4rem;
                margin-bottom: 12px;
            }

            p {
                font-size: 1rem;
            }

            .section-block {
                padding: 20px;
                margin-bottom: 25px;
            }

            .graph-section {
                padding: 25px;
                margin: 30px 0;
            }

            .code-block-wrapper {
                padding: 20px;
                margin-bottom: 25px;
            }

            .code-container {
                padding: 15px;
            }

            code {
                font-size: 0.85rem;
                padding-right: 50px;
            }

            .copy-btn {
                padding: 6px 10px;
                font-size: 0.7rem;
                top: 10px;
                right: 10px;
            }

            .button {
                width: 100%;
            }
            .theme-switch-wrapper {
                justify-content: center; /* Center toggle on small screens */
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 15px;
            }
            .report-container {
                padding: 20px;
            }
            h1 {
                font-size: 1.8rem;
            }
            h2 {
                font-size: 1.5rem;
            }
            h3 {
                font-size: 1.2rem;
            }
            ul {
                padding-left: 20px;
            }
        }
    </style>
</head>
<body>
<div id="stickyNavbar" style="position: fixed; top: 0; left: 0; right: 0; z-index: 10000; background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(6px); padding: 0.5rem; border-bottom: 1px solid var(--color-border); box-shadow: var(--shadow-subtle); display: flex; justify-content: space-between; align-items: center;">
  <h2 style="margin: 0; font-size: 1.25rem; color: var(--color-primary);">Dataset Actions</h2>
<div style="text-align: right; margin-top: 0.2rem; color:var(--color-primary); font-weight: 500; line-height: 1.4;">
  <p style="margin:0;">21 MIC 7040</p>
  <p style="margin:0;">Chandan Sathvik</p>
</div>

  <div class="button-group" style="margin: 0;">
    <a class="button secondary" download="yoyo.xlsx" href="yoyo.xlsx">Download Dataset</a>
  </div>
</div>


<div class="report-container">
<div class="theme-switch-wrapper">
<span>Light Mode</span>
<label class="theme-switch" for="checkbox">
<input id="checkbox" type="checkbox"/>
<div class="slider"></div>
</label>
<span>Dark Mode</span>
</div>
<h1>Genshin Impact Survey Analysis: Player Behavior &amp; Preferences</h1>
<div class="section-block highlight-primary">
<h2>Problem Statement (Objective)</h2>
<p>
                "Can we predict whether a player participates in Spiral Abyss based on their gameplay preferences and profile?"
            </p>
</div>
<div class="graph-section">
<h3>Cluster Analysis Graph</h3>
<img alt="Cluster Analysis Graph" onerror="this.onerror=null; this.src='https://placehold.co/600x400/eeeeee/aaaaaa?text=Image+Not+Found';" src="cluster_scatterplot_from_xlsx.png"/>
</div>
<div class="code-block-wrapper">
<h3>Python Code: Genshin Impact Player Clustering</h3>
<div class="code-container">
<pre><code id="clusterCode">
import pandas as pd
from sklearn.preprocessing import OneHotEncoder
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.cluster import KMeans # KMeans is needed to get the cluster labels

# Load the dataset
df = pd.read_excel('yoyo.xlsx')

clustering_cols = [col for col in df.columns if col.startswith('Q')]
df_clustering = df[clustering_cols].copy()
categorical_cols = df_clustering.columns

# Apply One-Hot Encoding
encoder = OneHotEncoder(handle_unknown='ignore', sparse_output=False)
encoded_features = encoder.fit_transform(df_clustering[categorical_cols])
encoded_df = pd.DataFrame(encoded_features, columns=encoder.get_feature_names_out(categorical_cols))

n_clusters = 3
kmeans = KMeans(n_clusters=n_clusters, random_state=42, n_init=10)
clusters = kmeans.fit_predict(encoded_df)

pca = PCA(n_components=2)
principal_components = pca.fit_transform(encoded_df)
pca_df = pd.DataFrame(data=principal_components, columns=['PC1', 'PC2'])
pca_df['Cluster'] = clusters

# Visualize the clusters using a scatter plot
plt.figure(figsize=(10, 8))
sns.scatterplot(x='PC1', y='PC2', hue='Cluster', palette='viridis', data=pca_df, s=100, alpha=0.8)
plt.title('2D PCA of Clusters')
plt.xlabel('Principal Component 1')
plt.ylabel('Principal Component 2')
plt.grid(True)
plt.savefig('cluster_scatterplot_from_xlsx.png') # Saves the plot to a file
plt.close() # Closes the plot to prevent it from displaying directly in some environments
                </code></pre>
<textarea class="hidden" id="clusterCodeText" readonly="">
import pandas as pd
from sklearn.preprocessing import OneHotEncoder
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.cluster import KMeans # KMeans is needed to get the cluster labels

# Load the dataset
df = pd.read_excel('yoyo.xlsx')

clustering_cols = [col for col in df.columns if col.startswith('Q')]
df_clustering = df[clustering_cols].copy()
categorical_cols = df_clustering.columns

# Apply One-Hot Encoding
encoder = OneHotEncoder(handle_unknown='ignore', sparse_output=False)
encoded_features = encoder.fit_transform(df_clustering[categorical_cols])
encoded_df = pd.DataFrame(encoded_features, columns=encoder.get_feature_names_out(categorical_cols))

n_clusters = 3
kmeans = KMeans(n_clusters=n_clusters, random_state=42, n_init=10)
clusters = kmeans.fit_predict(encoded_df)

pca = PCA(n_components=2)
principal_components = pca.fit_transform(encoded_df)
pca_df = pd.DataFrame(data=principal_components, columns=['PC1', 'PC2'])
pca_df['Cluster'] = clusters

# Visualize the clusters using a scatter plot
plt.figure(figsize=(10, 8))
sns.scatterplot(x='PC1', y='PC2', hue='Cluster', palette='viridis', data=pca_df, s=100, alpha=0.8)
plt.title('2D PCA of Clusters')
plt.xlabel('Principal Component 1')
plt.ylabel('Principal Component 2')
plt.grid(True)
plt.savefig('cluster_scatterplot_from_xlsx.png') # Saves the plot to a file
plt.close() # Closes the plot to prevent it from displaying directly in some environments
                </textarea>
<button class="copy-btn" data-target-code-id="clusterCodeText">Copy Code</button>
</div>
</div>
<h2>Cluster Insights</h2>
<div class="section-block">
<h3>Cluster 0 Insights:</h3>
<ul>
<li>Predominantly mobile players (100.00%).</li>
<li>Top favorite region is Inazuma (25.00%).</li>
<li>Top favorite element is Hydro (31.25%).</li>
<li>Top favorite weapon type is Bow (31.25%).</li>
<li>Most of these players do play Spiral Abyss (100.00%) and have an Adventure Rank of 60 (62.50%).</li>
<li>Their top favorite Archon is Venti (31.25%).</li>
</ul>
</div>
<div class="section-block">
<h3>Cluster 1 Insights:</h3>
<ul>
<li>Mainly PC players (94.44%).</li>
<li>Also show a strong preference for Inazuma region (33.33%).</li>
<li>Top favorite element is Dendro (27.78%).</li>
<li>Top favorite weapon type is Polearm (38.89%).</li>
<li>Most do play Spiral Abyss (83.33%) and have an Adventure Rank of 60 (83.33%).</li>
<li>Their top favorite Archon is Furina (33.33%).</li>
</ul>
</div>
<div class="section-block highlight-accent">
<h3>Cluster 2 Insights:</h3>
<ul>
<li>A mixed group in terms of platform, with mobile being the most frequent (37.50%).</li>
<li>Have a clear preference for the Sumeru region (43.75%).</li>
<li>Top favorite element is Pyro (25.00%).</li>
<li>Top favorite weapon type is Bow (37.50%).</li>
<li>Notably, none of the players in this cluster play Spiral Abyss (100.00% 'no'). Their Adventure Rank is often 60 (37.50%), but this is less dominant than in other clusters.</li>
<li>Their top favorite Archon is Nahida (25.00%).</li>
</ul>
</div>
<h2>Overall Key Findings</h2>
<div class="graph-section">
<h3>Platform Preference Graph</h3>
<img alt="Platform Preference Graph" onerror="this.onerror=null; this.src='https://placehold.co/600x400/eeeeee/aaaaaa?text=Image+Not+Found';" src="most_popular_platforms_bar_chart_corrected.png"/>
</div>
<div class="code-block-wrapper">
<h3>Python Code: Platform Preference Bar Chart</h3>
<div class="code-container">
<pre><code id="platformChartCode">
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Load the dataset
df = pd.read_excel('yoyo.xlsx')

df['Q1. What platform do you usually play Genshin Impact on?'] = df['Q1. What platform do you usually play Genshin Impact on?'].replace({
    'mocile': 'mobile',
    'movile': 'mobile'
})

platform_data_corrected = df['Q1. What platform do you usually play Genshin Impact on?']

plt.figure(figsize=(10, 6))
sns.countplot(y=platform_data_corrected, order=platform_data_corrected.value_counts().index, palette='viridis')
plt.title('Most Popular Platforms for Playing Genshin Impact (Corrected)')
plt.xlabel('Number of Respondents')
plt.ylabel('Platform')
plt.grid(axis='x', linestyle='--', alpha=0.7)
plt.tight_layout()
plt.savefig('most_popular_platforms_bar_chart_corrected.png')
plt.close()

print("Typos corrected and updated bar chart for 'Most Popular Platforms' generated successfully.")
                </code></pre>
<textarea class="hidden" id="platformChartCodeText" readonly="">
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Load the dataset
df = pd.read_excel('yoyo.xlsx')

df['Q1. What platform do you usually play Genshin Impact on?'] = df['Q1. What platform do you usually play Genshin Impact on?'].replace({
    'mocile': 'mobile',
    'movile': 'mobile'
})

platform_data_corrected = df['Q1. What platform do you usually play Genshin Impact on?']

plt.figure(figsize=(10, 6))
sns.countplot(y=platform_data_corrected, order=platform_data_corrected.value_counts().index, palette='viridis')
plt.title('Most Popular Platforms for Playing Genshin Impact (Corrected)')
plt.xlabel('Number of Respondents')
plt.ylabel('Platform')
plt.grid(axis='x', linestyle='--', alpha=0.7)
plt.tight_layout()
plt.savefig('most_popular_platforms_bar_chart_corrected.png')
plt.close()

print("Typos corrected and updated bar chart for 'Most Popular Platforms' generated successfully.")
                </textarea>
<button class="copy-btn" data-target-code-id="platformChartCodeText">Copy Code</button>
</div>
</div>
<div class="section-block">
<h3>Preferred Gaming Platforms</h3>
<ul>
<li><strong>PC Dominance:</strong> The data clearly indicates that PC is the most preferred platform for playing Genshin Impact among the surveyed individuals, accounting for the largest proportion of respondents.</li>
<li><strong>Strong Mobile Presence:</strong> Mobile devices represent the second most popular platform, showing a substantial segment of players who prefer handheld gaming for Genshin Impact. This indicates the game's significant reach on portable devices.</li>
<li><strong>Limited Console Preference:</strong> PlayStation (PS) usage is notably lower compared to both PC and Mobile, suggesting that console gaming, at least among this specific respondent group, is a less common choice for Genshin Impact.</li>
</ul>
</div>
<div class="section-block">
<h3>Region and Archon Preference Alignment</h3>
<div class="graph-section">
<h3>Region vs. Archon Preference Graph</h3>
<img alt="Region vs. Archon Preference Graph" src="region_archon_preference_grouped_bar_chart.png"/>
</div>
<div class="code-block-wrapper">
<h3>Python Code: Region vs. Archon Preference Grouped Bar Chart</h3>
<div class="code-container">
<pre><code id="regionArchonChartCode">
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_excel('yoyo.xlsx')

df['Q1. What platform do you usually play Genshin Impact on?'] = df['Q1. What platform do you usually play Genshin Impact on?'].replace({
    'mocile': 'mobile',
    'movile': 'mobile'
})

region_col = 'Q2. Which region in the game is your favorite?'
archon_col = 'Q7. Who is your favourite archon?'

# Create a grouped bar chart
plt.figure(figsize=(14, 8))
sns.countplot(data=df, x=region_col, hue=archon_col, palette='tab10')

plt.title('Region Preference by Favourite Archon')
plt.xlabel('Favourite Region')
plt.ylabel('Number of Respondents')
plt.xticks(rotation=45, ha='right') # Rotate x-axis labels for readability
plt.legend(title='Favourite Archon', bbox_to_anchor=(1.05, 1), loc='upper left') # Move legend outside
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.tight_layout() # Adjust layout to prevent labels from overlapping
plt.savefig('region_archon_preference_grouped_bar_chart.png') # Saving to a general name
plt.close()

print("Grouped bar chart for Region and Archon Preference generated successfully.")
                    </code></pre>
<textarea class="hidden" id="regionArchonChartCodeText" readonly="">
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_excel('yoyo.xlsx')

df['Q1. What platform do you usually play Genshin Impact on?'] = df['Q1. What platform do you usually play Genshin Impact on?'].replace({
    'mocile': 'mobile',
    'movile': 'mobile'
})

region_col = 'Q2. Which region in the game is your favorite?'
archon_col = 'Q7. Who is your favourite archon?'

# Create a grouped bar chart
plt.figure(figsize=(14, 8))
sns.countplot(data=df, x=region_col, hue=archon_col, palette='tab10')

plt.title('Region Preference by Favourite Archon')
plt.xlabel('Favourite Region')
plt.ylabel('Number of Respondents')
plt.xticks(rotation=45, ha='right') # Rotate x-axis labels for readability
plt.legend(title='Favourite Archon', bbox_to_anchor=(1.05, 1), loc='upper left') # Move legend outside
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.tight_layout() # Adjust layout to prevent labels from overlapping
plt.savefig('region_archon_preference_grouped_bar_chart.png') # Saving to a general name
plt.close()

print("Grouped bar chart for Region and Archon Preference generated successfully.")
                    </textarea>
<button class="copy-btn" data-target-code-id="regionArchonChartCodeText">Copy Code</button>
</div>
</div>
<ul>
<li><strong>Strong Alignment of Region and Archon Preference:</strong> For most regions, there's a very strong tendency for respondents to favor the Archon associated with that specific region.</li>
<li><strong>Mondstadt:</strong> Players whose favorite region is Mondstadt overwhelmingly prefer Venti.</li>
<li><strong>Liyue:</strong> Similarly, Zhongli is the clear favorite among Liyue enthusiasts.</li>
<li><strong>Inazuma:</strong> The Raiden Shogun (Ei) is the dominant choice for those who favor Inazuma.</li>
<li><strong>Sumeru:</strong> Nahida is the most preferred Archon by players who choose Sumeru as their favorite region.</li>
<li><strong>Fontaine:</strong> Furina is the most popular Archon among those who favor Fontaine.</li>
<li><strong>Minor Cross-Regional Preferences:</strong> While the primary alignment is strong, the chart also shows a smaller number of players who might prefer an Archon from a different region than their favorite. For example, some Mondstadt fans might like Nahida, or some Liyue fans might like Furina, but these numbers are significantly lower than the region-specific Archon preference.</li>
<li><strong>Insights into Character Affinity:</strong> This strong correlation suggests that players often develop a deep connection to the lore, aesthetics, and characters of a region, with the Archon serving as a central figure embodying that region's appeal. It indicates that the Archons are highly successful in representing their respective nations in the eyes of players.</li>
</ul>
</div>
<div class="code-block-wrapper">
<h3>Python Code: Random Forest Classifier for Platform Prediction</h3>
<div class="code-container">
<pre><code id="predictionCode">
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import OneHotEncoder
from sklearn.metrics import accuracy_score

# Define the input file name - this MUST match the file you have saved
input_file_name = 'genshin_data.xlsx - Sheet1.csv'

try:
    # Load the dataset
    df = pd.read_csv(input_file_name)

    # Apply preprocessing: Standardize platform names in Q1 (target variable)
    if 'Q1. What platform do you usually play Genshin Impact on?' in df.columns:
        df['Q1. What platform do you usually play Genshin Impact on?'] = df['Q1. What platform do you usually play Genshin Impact on?'].replace({
            'mocile': 'mobile',
            'movile': 'mobile'
        })
    else:
        print("Warning: 'Q1. What platform do you usually play Genshin Impact on?' column not found for platform correction.")
        raise ValueError("Target column 'Q1. What platform do you usually play Genshin Impact on?' not found.")

    # Apply preprocessing: Capitalize the first letter of 'user' column entries
    if 'user' in df.columns:
        df['user'] = df['user'].astype(str).str.capitalize()
    # No else warning needed, as 'user' is not a feature/target

    # Define target and features
    target_column = 'Q1. What platform do you usually play Genshin Impact on?'
    # Features are all other 'Q' columns excluding the target
    feature_columns = [col for col in df.columns if col.startswith('Q') and col != target_column]

    X = df[feature_columns]
    y = df[target_column]

    # One-Hot Encode the features (X)
    # Ensure all feature columns are treated as categorical for encoding
    encoder = OneHotEncoder(handle_unknown='ignore', sparse_output=False)
    X_encoded = encoder.fit_transform(X)
    X_encoded_df = pd.DataFrame(X_encoded, columns=encoder.get_feature_names_out(feature_columns))

    # Split the data into training and testing sets
    # Using stratify=y to maintain the same proportion of target classes in train and test sets
    X_train, X_test, y_train, y_test = train_test_split(X_encoded_df, y, test_size=0.3, random_state=42, stratify=y)

    # Initialize and train the Random Forest Classifier
    rf_classifier = RandomForestClassifier(n_estimators=100, random_state=42)
    rf_classifier.fit(X_train, y_train)

    # Make predictions on the test set
    y_pred = rf_classifier.predict(y_test)

    # Calculate the accuracy
    accuracy = accuracy_score(y_test, y_pred)

    print(f"The Accuracy of the Random Forest Classifier is: {accuracy:.2f}")

    print("\nWhat this Accuracy means:")
    print("  - Accuracy measures the proportion of correctly predicted instances out of the total instances.")
    print("  - In this case, it indicates how well the model can predict a player's favorite platform ('Q1') based on their other in-game preferences (region, element, weapon, favorite/hated characters).")
    print(f"  - An accuracy of {accuracy:.2%} means that the model correctly predicted the platform for {accuracy:.2%} of the players in the test set.")

except FileNotFoundError:
    print(f"Error: The file '{input_file_name}' was not found.")
    print("Please ensure the file is in the same directory as your Python script, or provide the full path.")
except ValueError as ve:
    print(f"Data Error: {ve}")
except Exception as e:
    print(f"An unexpected error occurred: {e}")
                </code></pre>
<textarea class="hidden" id="predictionCodeText" readonly="">
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import OneHotEncoder
from sklearn.metrics import accuracy_score

# Define the input file name - this MUST match the file you have saved
input_file_name = 'genshin_data.xlsx - Sheet1.csv'

try:
    # Load the dataset
    df = pd.read_csv(input_file_name)

    # Apply preprocessing: Standardize platform names in Q1 (target variable)
    if 'Q1. What platform do you usually play Genshin Impact on?' in df.columns:
        df['Q1. What platform do you usually play Genshin Impact on?'] = df['Q1. What platform do you usually play Genshin Impact on?'].replace({
            'mocile': 'mobile',
            'movile': 'mobile'
        })
    else:
        print("Warning: 'Q1. What platform do you usually play Genshin Impact on?' column not found for platform correction.")
        raise ValueError("Target column 'Q1. What platform do you usually play Genshin Impact on?' not found.")

    # Apply preprocessing: Capitalize the first letter of 'user' column entries
    if 'user' in df.columns:
        df['user'] = df['user'].astype(str).str.capitalize()
    # No else warning needed, as 'user' is not a feature/target

    # Define target and features
    target_column = 'Q1. What platform do you usually play Genshin Impact on?'
    # Features are all other 'Q' columns excluding the target
    feature_columns = [col for col in df.columns if col.startswith('Q') and col != target_column]

    X = df[feature_columns]
    y = df[target_column]

    # One-Hot Encode the features (X)
    # Ensure all feature columns are treated as categorical for encoding
    encoder = OneHotEncoder(handle_unknown='ignore', sparse_output=False)
    X_encoded = encoder.fit_transform(X)
    X_encoded_df = pd.DataFrame(X_encoded, columns=encoder.get_feature_names_out(feature_columns))

    # Split the data into training and testing sets
    # Using stratify=y to maintain the same proportion of target classes in train and test sets
    X_train, X_test, y_train, y_test = train_test_split(X_encoded_df, y, test_size=0.3, random_state=42, stratify=y)

    # Initialize and train the Random Forest Classifier
    rf_classifier = RandomForestClassifier(n_estimators=100, random_state=42)
    rf_classifier.fit(X_train, y_train)

    # Make predictions on the test set
    y_pred = rf_classifier.predict(X_test)

    # Calculate the accuracy
    accuracy = accuracy_score(y_test, y_pred)

    print(f"The Accuracy of the Random Forest Classifier is: {accuracy:.2f}")

    print("\nWhat this Accuracy means:")
    print("  - Accuracy measures the proportion of correctly predicted instances out of the total instances.")
    print("  - In this case, it indicates how well the model can predict a player's favorite platform ('Q1') based on their other in-game preferences (region, element, weapon, favorite/hated characters).")
    print(f"  - An accuracy of {accuracy:.2%} means that the model correctly predicted the platform for {accuracy:.2%} of the players in the test set.")

except FileNotFoundError:
    print(f"Error: The file '{input_file_name}' was not found.")
    print("Please ensure the file is in the same directory as your Python script, or provide the full path.")
except ValueError as ve:
    print(f"Data Error: {ve}")
except Exception as e:
    print(f"An unexpected error occurred: {e}")
                </textarea>
<button class="copy-btn" data-target-code-id="predictionCodeText">Copy Code</button>
</div>
<div style="background: var(--color-card-background); color: var(--color-text-dark); padding: 1rem 1.5rem; border-radius: 12px; box-shadow: var(--shadow-subtle); border: 1px solid var(--color-border); margin: 1.5rem 0;">
  <p><strong>Prediction Accuracy:</strong> 46.67%</p>
</div>
</div>
<hr/>
</div>
</div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const datasetPreviewDiv = document.getElementById('dataset-preview');
        const themeToggle = document.getElementById('checkbox');
        const body = document.body;
        let isDatasetPreviewVisible = false;

        // --- Theme Switching Logic ---
        const currentTheme = localStorage.getItem('theme');
        if (currentTheme) {
            body.classList.add(currentTheme);
            if (currentTheme === 'dark-mode') {
                themeToggle.checked = true;
            }
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            body.classList.add('dark-mode');
            themeToggle.checked = true;
            localStorage.setItem('theme', 'dark-mode');
        } else {
            localStorage.setItem('theme', 'light-mode');
        }

        themeToggle.addEventListener('change', () => {
            if (themeToggle.checked) {
                body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark-mode');
            } else {
                body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light-mode');
            }
        });

        // --- Copy to Clipboard Function ---
        const copyToClipboard = (elementId) => {
            const codeElement = document.getElementById(elementId);
            if (codeElement) {
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = codeElement.value;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextArea);

                const button = document.querySelector(`[data-target-code-id="${elementId}"]`);
                if (button) {
                    const originalText = button.textContent;
                    button.textContent = 'Copied!';
                    setTimeout(() => {
                        button.textContent = originalText;
                    }, 2000);
                }
            }
        };

        // --- Render CSV string into an HTML table ---
        const renderTableFromCsv = (csvString) => {
            const lines = csvString.trim().split('\n');
            if (lines.length === 0) {
                return '<p>No data found in the file.</p>';
            }

            let html = '<table>';
            html += '<thead><tr>';
            const headers = lines[0].split(',');
            headers.forEach(headerText => {
                html += `<th>${headerText.trim()}</th>`;
            });
            html += '</tr></thead>';

            html += '<tbody>';
            for (let i = 1; i < lines.length; i++) {
                html += '<tr>';
                const cells = lines[i].split(',');
                cells.forEach(cellText => {
                    html += `<td>${cellText.trim()}</td>`;
                });
                html += '</tr>';
            }
            html += '</tbody></table>';
            return html;
        };

        // --- Fetch and process XLSX for preview ---
        const fetchAndRenderXLSX = async () => {
            datasetPreviewDiv.innerHTML = '<p>Loading dataset preview...</p>';
            try {
                if (typeof XLSX === 'undefined') {
                    console.error('SheetJS (XLSX) library not loaded.');
                    datasetPreviewDiv.innerHTML = '<p style="color: red;">XLSX library not loaded.</p>';
                    return;
                }

                const response = await fetch('yoyo.xlsx');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                const csvText = XLSX.utils.sheet_to_csv(worksheet);

                datasetPreviewDiv.innerHTML = renderTableFromCsv(csvText);
            } catch (error) {
                console.error('Error fetching or processing XLSX:', error);
                datasetPreviewDiv.innerHTML = `<p style="color: red;">Failed to load XLSX dataset: ${error.message}</p>`;
            }
        };

        // --- Sticky navbar spacing ---
        document.body.style.paddingTop = '70px';

        // --- Set up copy buttons ---
        document.querySelectorAll('.copy-btn').forEach(button => {
            button.addEventListener('click', () => copyToClipboard(button.dataset.targetCodeId));
        });
    });
</script>

</body>
</html>


